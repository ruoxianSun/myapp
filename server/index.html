<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <script type="text/javascript">

            window.onload = function () {
                var baseUrl = "ws://localhost:8888";
                console.log("Connecting to WebSocket server at " + baseUrl + ".");
                var socket = new WebSocket(baseUrl);
                socket.onclose = function () {
                    console.error("web channel closed");
                };
                socket.onerror = function (error) {
                    console.error("web channel error: " + error);
                };
                socket.onopen = function () {
                    console.log("WebSocket connected, setting up QWebChannel.");
                }
                function sendJson(obj) {
                    var content = JSON.stringify(obj);
                    socket.send(content);
                };
                var canvase = document.getElementById("canvase");
                canvase.style.width = document.body.innerHTML.width;
                canvase.style.height = document.body.innerHTML.height;
                console.log("canvase size", canvase);
                canvase.onmousedown = function (ev) {

                    var content = {
                        "uri": "app.protocol.mouseevent",
                        "type": "mousedown",
                        "button": ev.button,
                        "buttons": ev.buttons,
                        "x": ev.x,
                        "y": ev.y,
                        "modifys": ev.modifys,
                    };
                    console.log("onmousedown".content);
                    sendJson(content);
                }
                canvase.onmousemove = function (ev) {
                    var content = {
                        "uri": "app.protocol.mouseevent",
                        "type": "mousemove",
                        "button": ev.button,
                        "buttons": ev.buttons,
                        "x": ev.x,
                        "y": ev.y,
                        "modifys": ev.modifys,
                    };
                    console.log("onmousemove".content);
                    //sendJson(content);
                }
                canvase.onmouseup = function (ev) {
                    var content = {
                        "uri": "app.protocol.mouseevent",
                        "type": "mouseup",
                        "button": ev.button,
                        "buttons": ev.buttons,
                        "x": ev.x,
                        "y": ev.y,
                        "modifys": ev.modifys,
                    };
                    console.log("onmouseup".content);
                    sendJson(content);
                }
            }
        </script>
    </head>
    <body>
        <div id="canvase" style="border:1px;border-color:black;width:800px;height:600px;">

        </div>
        
    </body>
</html>